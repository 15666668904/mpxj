<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->

<!-- Generated by Apache Maven Doxia Site Renderer 1.4 at 2017-03-23 -->
<html x="y" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>MPXJ - 
      How To: Work with a Primavera database</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
      <meta name="author" content="Jon Iles" />
    <meta name="Date-Revision-yyyymmdd" content="20170323" />
    <meta http-equiv="Content-Language" content="en" />
        
          <!-- Google Analytics -->
    <script type="text/javascript">
    
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-7202224-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    </head>
    
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                MPXJ
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
        <span id="publishDate">Last Published: 2017-03-23</span>
                      </div>
            <div class="xright">        
                    
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                <h5>MPXJ</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Overview">Overview</a>
            </li>
                  <li class="none">
                          <a href="changes-report.html" title="Changes">Changes</a>
            </li>
                                                                                                                                                                                                                                                                                    <li class="expanded">
                          <a href="howto.html" title="How to...">How to...</a>
                    <ul>
                      <li class="none">
                          <a href="howto-start.html" title="Get started">Get started</a>
            </li>
                      <li class="none">
                          <a href="howto-build.html" title="Build MPXJ">Build MPXJ</a>
            </li>
                      <li class="none">
                          <a href="howto-dotnet.html" title="Use MPXJ with .Net">Use MPXJ with .Net</a>
            </li>
                      <li class="none">
                          <a href="howto-com.html" title="Use MPXJ with COM">Use MPXJ with COM</a>
            </li>
                      <li class="none">
                          <a href="howto-maven.html" title="Use MPXJ with Maven">Use MPXJ with Maven</a>
            </li>
                      <li class="none">
                          <a href="howto-convert.html" title="Convert files">Convert files</a>
            </li>
                      <li class="none">
                          <a href="howto-mpx.html" title="Work with MPX files">Work with MPX files</a>
            </li>
                      <li class="none">
                          <a href="howto-mpp.html" title="Work with MPP files">Work with MPP files</a>
            </li>
                      <li class="none">
                          <a href="howto-mspdi.html" title="Work with MSPDI files">Work with MSPDI files</a>
            </li>
                      <li class="none">
                          <a href="howto-planner.html" title="Work with Planner files">Work with Planner files</a>
            </li>
                      <li class="none">
                          <a href="howto-powerproject.html" title="Work with Powerproject files">Work with Powerproject files</a>
            </li>
                      <li class="none">
            <strong>Work with a Primavera database</strong>
          </li>
              </ul>
        </li>
                  <li class="none">
                          <a href="faq.html" title="FAQ">FAQ</a>
            </li>
                  <li class="none">
                          <a href="users.html" title="Users">Users</a>
            </li>
                  <li class="none">
                          <a href="roadmap.html" title="Roadmap">Roadmap</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                            <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                        <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
             	
                             
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        
    

<div class="section">
<h2>How To: Work with a Primavera database<a name="How_To:_Work_with_a_Primavera_database"></a></h2>


<p>Reading from a Primavera database is a slightly different proposition
to reading file-based project data, as a database connection is required.
The example below illustrates how to do this for a Primavera database
hosted in SQL Server, using the open source JTDS JDBC driver. 
The only difference when reading from an Oracle
database will be the JDBC driver and connection string used.</p>


<div class="source">
<pre>
import java.sql.Connection;
import java.sql.DriverManager;
import net.sf.mpxj.ProjectFile;
import net.sf.mpxj.primavera.PrimaveraDatabaseReader;

...

//
// Load the JDBC driver
//
String driverClass=&quot;net.sourceforge.jtds.jdbc.Driver&quot;;
Class.forName(driverClass);

//
// Open a database connection. You will need to change
// these details to match the name of your server, database, user and password.
//
String connectionString=&quot;jdbc:jtds:sqlserver://localhost/PMDB;user=pmdb;password=pmdb&quot;;
Connection c = DriverManager.getConnection(connectionString);
PrimaveraDatabaseReader reader = new PrimaveraDatabaseReader();
reader.setConnection(c);

//
// Retrieve a list of the projects available in the database
//
Map&lt;Integer,String&gt; projects = reader.listProjects();

//
// At this point you'll select the project
// you want to work with.
//

//
// Now open the selected project using its ID
//
int selectedProjectID = 1;
reader.setProjectID(selectedProjectID);
ProjectFile projectFile = reader.read();

</pre></div>


<p>You can also connect to a standalone SQLite P6 database, although a 
property has to be set on the database connection in order for
date and time values to be read correctly.</p>



<div class="source">
<pre>
import java.sql.Connection;
import java.sql.DriverManager;
import net.sf.mpxj.ProjectFile;
import net.sf.mpxj.primavera.PrimaveraDatabaseReader;

...

//
// Load the JDBC driver
//
String driverClass=&quot;&quot;org.sqlite.JDBC&quot;;
Class.forName(driverClass);

//
// Open a database connection. You will need to change
// these details to match the location of your database file.
//
String connectionString=&quot;jdbc:sqlite:C:/temp/PPMDBSQLite.db&quot;;
Properties props = new Properties();
props.setProperty(&quot;date_string_format&quot;, &quot;yyyy-MM-dd HH:mm:ss&quot;);
Connection c = DriverManager.getConnection(connectionString, props);
PrimaveraDatabaseReader reader = new PrimaveraDatabaseReader();
reader.setConnection(c);

//
// Retrieve a list of the projects available in the database
//
Map&lt;Integer,String&gt; projects = reader.listProjects();

//
// At this point you'll select the project
// you want to work with.
//

//
// Now open the selected project using its ID
//
int selectedProjectID = 1;
reader.setProjectID(selectedProjectID);
ProjectFile projectFile = reader.read();

</pre></div>

</div>



      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2000&#x2013;2017
                        <a href="http://mpxj.org">Packwood Software</a>.
            All rights reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>