<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->

<!-- Generated by Apache Maven Doxia Site Renderer 1.4 at 2017-03-23 -->
<html x="y" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>MPXJ - 
      How To: Use MPXJ with .Net</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
      <meta name="author" content="Jon Iles" />
    <meta name="Date-Revision-yyyymmdd" content="20170323" />
    <meta http-equiv="Content-Language" content="en" />
        
          <!-- Google Analytics -->
    <script type="text/javascript">
    
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-7202224-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    </head>
    
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                MPXJ
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
        <span id="publishDate">Last Published: 2017-03-23</span>
                      </div>
            <div class="xright">        
                    
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                <h5>MPXJ</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Overview">Overview</a>
            </li>
                  <li class="none">
                          <a href="changes-report.html" title="Changes">Changes</a>
            </li>
                                                                                                                                                                                                                                                                                    <li class="expanded">
                          <a href="howto.html" title="How to...">How to...</a>
                    <ul>
                      <li class="none">
                          <a href="howto-start.html" title="Get started">Get started</a>
            </li>
                      <li class="none">
                          <a href="howto-build.html" title="Build MPXJ">Build MPXJ</a>
            </li>
                      <li class="none">
            <strong>Use MPXJ with .Net</strong>
          </li>
                      <li class="none">
                          <a href="howto-com.html" title="Use MPXJ with COM">Use MPXJ with COM</a>
            </li>
                      <li class="none">
                          <a href="howto-maven.html" title="Use MPXJ with Maven">Use MPXJ with Maven</a>
            </li>
                      <li class="none">
                          <a href="howto-convert.html" title="Convert files">Convert files</a>
            </li>
                      <li class="none">
                          <a href="howto-mpx.html" title="Work with MPX files">Work with MPX files</a>
            </li>
                      <li class="none">
                          <a href="howto-mpp.html" title="Work with MPP files">Work with MPP files</a>
            </li>
                      <li class="none">
                          <a href="howto-mspdi.html" title="Work with MSPDI files">Work with MSPDI files</a>
            </li>
                      <li class="none">
                          <a href="howto-planner.html" title="Work with Planner files">Work with Planner files</a>
            </li>
                      <li class="none">
                          <a href="howto-powerproject.html" title="Work with Powerproject files">Work with Powerproject files</a>
            </li>
                      <li class="none">
                          <a href="howto-primavera.html" title="Work with a Primavera database">Work with a Primavera database</a>
            </li>
              </ul>
        </li>
                  <li class="none">
                          <a href="faq.html" title="FAQ">FAQ</a>
            </li>
                  <li class="none">
                          <a href="users.html" title="Users">Users</a>
            </li>
                  <li class="none">
                          <a href="roadmap.html" title="Roadmap">Roadmap</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                            <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                        <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
             	
                             
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        
    

<div class="section">
<h2>MPXJ assemblies<a name="MPXJ_assemblies"></a></h2>

<p>MPXJ ships with both a Java library (mpxj.jar) and a set of .Net assemblies, 
which can be found in the lib.net folder of the distribution. MPXJ is also available through <a class="externalLink" href="http://www.nuget.org/packages?q=mpxj" target="_blank">NuGet</a>.</p> 


<p>There are actually three different .Net DLLs shipped with MPXJ - you only need one of these:</p>


<ul>

<li><b>mpxj.dll</b> - this is the default .Net version, the API is identical to the Java version</li>

<li><b>mpxj-for-csharp.dll</b> - in this version the API has been modified to make it less like Java and more like C#: 
there are properties rather than getter and setter methods, and the method names follow the same uppercase initial letter convention used by C#.</li>

<li><b>mpxj-for-vb.dll</b> - this version also transforms getters and setters into properties, but the method names are unchanged. 
VB is case insensitive and can't cope with the seeing two methods whose name differs only by case</li>
</ul>


<p>As noted above, in the &quot;for C#&quot; and &quot;for VB&quot; versions of the MPXJ DLL, getters and setters have been
replaced by properties. For example, where you would have previously written code like this:</p>

<div class="source">
<pre>
String text = task.getText();
task.setText(text);
</pre></div>

<p>Now when you work with the &quot;for C#&quot; and &quot;for VB&quot; versions of the MPXJ DLL, you'll be able to write code in a more familiar style:</p>

<div class="source">
<pre>
String text = task.Text
task.Text = text;
</pre></div>


<p>Also noted above, in the case of the &quot;for C#&quot; MPXJ DLL, method names have been modified to begin with an initial capital,
so the code will again have a more familiar style. For example, using the original Java method names you'd write something like this:</p>


<div class="source">
<pre>
Task task = projectFile.addTask();
</pre></div>


<p>Using the &quot;for C#&quot; DLL your code will look like this:</p>


<div class="source">
<pre>
Task task = projectFile.AddTask();
</pre></div>

</div>


<div class="section">
<h2>MPXJ dependencies<a name="MPXJ_dependencies"></a></h2>

<p>Once you have selected the version of the MPXJ DLL most suitable for your project, you will need to add its dependencies. The files you'll need are listed below:</p>


<ul>

<li>IKVM*.dll</li>

<li>poi*.dll</li>
</ul>
</div>


<div class="section">
<h2>.Net samples<a name="a.Net_samples"></a></h2>

<p>MPXJ ships with some sample files which can be found in the src.net
folder of the distribution. These files illustrate how the MPXJ API can be 
used to manipulate project data. In particular the MpxjQuery sample files
show how various elements which make up the project data can be queried.
Two versions of this utility are present in src.net, one written in C#,
and the other written in Visual Basic (VB) to illustrate the basics of using
MPXJ in either language. Even if you are developing software in a .Net
language you may still find it useful to refer to the Java examples, and
indeed the original Java source of MPXJ to give you an insight into how the
API may be used.</p>
</div>


<div class="section">
<h2>.Net and Java types<a name="a.Net_and_Java_types"></a></h2>

<p>The .Net version of MPXJ has been generated directly from the Java
version using a tool called IKVM. One of the side effects of using IKVM to
perform this conversion is that the MPXJ exposes .Net versions of the
original Java data types, so for example you will find that the API returns
a type called Date rather than a .Net DateTime, and collections which 
don't expose the familiar IEnumerable interface.</p>


<p>To simplify the translation between Java and .Net types, as set of extension methods have been provided.
You'll find these extension methods in the src.net
folder, in a project called MpxjExtensionMethods. This project contains
extension methods which enhance both Java and .Net classes to make it easier to
pass data to and from the API. For example the extension method ToIEnumerable 
is added to Java collection data types which allows them to be iterated using 
the familiar foreach .Net syntax.</p>


<p>To use these extension methods, simply add a reference to the 
MpxjExtensionMethods assembly
in your own project. The methods themselves are documented in the source, and
examples of their use can be seen in the samples provided in the src.net folder.</p>
</div>


<div class="section">
<h2>MPXJ and the GAC<a name="MPXJ_and_the_GAC"></a></h2>

<p>For your convenience two batch files are provided in the lib.net directory: mpxj-gac-install.bat and mpxj-gac-uninstall.bat.
These batch files install the MPXJ assemblies into the GAC and uninstall the MPXJ assemblies from the GAC 
using the <a class="externalLink" href="http://msdn.microsoft.com/en-us/library/ex0ss12c(v=vs.110).aspx" target="_blank">gacutil global assembly cache tool.</a>
Note that these batch files assume that gacutil is available on the path.
</p>
</div>



      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2000&#x2013;2017
                        <a href="http://mpxj.org">Packwood Software</a>.
            All rights reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>